<Window
    x:Class="Codumentor.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:Codumentor.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:Codumentor"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="clr-namespace:Codumentor.ViewModels"
    xmlns:views="clr-namespace:Codumentor.Views"
    Title="Codumentor"
    Width="500"
    Height="450"
    FontSize="14"
    Foreground="White"
    Icon="/Resources/favicon.ico"
    ResizeMode="CanMinimize"
    WindowStartupLocation="CenterScreen"
    WindowStyle="None"
    mc:Ignorable="d">
    <Window.DataContext>
        <viewmodels:MainViewModel />
    </Window.DataContext>
    <Grid>
        <Grid
            local:DragDropBehavior.DropCommand="{Binding DropCommand}"
            AllowDrop="True"
            Background="#1f1f1f">

            <Grid.RowDefinitions>
                <RowDefinition Height="auto" />
                <RowDefinition Height="auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="auto" />
            </Grid.RowDefinitions>

            <views:TitleBar />

            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="auto" />
                </Grid.ColumnDefinitions>

                <TextBox
                    Grid.Column="0"
                    Margin="10"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Center"
                    materialDesign:HintAssist.Hint="Путь к папке"
                    materialDesign:TextFieldAssist.HasClearButton="True"
                    Text="{Binding FolderPath, UpdateSourceTrigger=PropertyChanged}" />

                <Button
                    Grid.Column="1"
                    Width="130"
                    Margin="10"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Command="{Binding OpenFolderDialogCommand}"
                    Content="Выбрать папку" />
            </Grid>

            <ListView
                Grid.Row="2"
                Margin="10"
                ItemContainerStyle="{StaticResource NoSelectionListViewItemStyle}"
                ItemTemplate="{StaticResource FilePathItemTemplate}"
                ItemsSource="{Binding FilePaths}" />

            <TextBlock
                Grid.Row="2"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                FontSize="20"
                Text="Перетащите сюда файлы с кодом">
                <TextBlock.Style>
                    <Style TargetType="TextBlock">
                        <Setter Property="Visibility" Value="Collapsed" />
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding FilePaths.Count}" Value="0">
                                <Setter Property="Visibility" Value="Visible" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
            </TextBlock>

            <Button
                Grid.Row="3"
                Margin="10"
                Command="{Binding ExportToWordCommand}"
                Content="Сгенерировать документ"
                FontSize="18" />

            <materialDesign:Snackbar
                Grid.Row="2"
                Margin="16"
                HorizontalAlignment="Right"
                VerticalAlignment="Bottom"
                Background="#2e2e2e"
                Foreground="White"
                MessageQueue="{Binding SnackMessageQueue}" />

        </Grid>

        <!--  Боковое меню  -->
        <Border
            Width="200"
            Margin="0,35,0,0"
            HorizontalAlignment="Left"
            Background="#333"
            RenderTransformOrigin="0,0">
            <Border.RenderTransform>
                <TranslateTransform x:Name="MenuTransform" X="-200" />
            </Border.RenderTransform>

            <Grid>
                <StackPanel>
                    <Button
                        Background="Transparent"
                        BorderBrush="Transparent"
                        Content="Пункт 1"
                        Foreground="White" />
                    <Button
                        Background="Transparent"
                        BorderBrush="Transparent"
                        Content="Пункт 2"
                        Foreground="White" />
                    <Button
                        Background="Transparent"
                        BorderBrush="Transparent"
                        Content="Пункт 3"
                        Foreground="White" />
                </StackPanel>

                <Button
                    Width="30"
                    Height="60"
                    Margin="0,0,-20,0"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Command="{Binding ToggleMenuCommand}"
                    Style="{StaticResource TransparentButton}">
                    <Button.Content>
                        <Path
                            Width="24"
                            Height="24"
                            Data="M400,-280 V-680 L600,-480 L400,-280 Z"
                            Fill="#e3e3e3"
                            Stretch="Uniform" />
                    </Button.Content>
                </Button>
            </Grid>

            <!--  DataTrigger для открытия/закрытия  -->
            <Border.Style>
                <Style TargetType="Border">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsMenuOpen}" Value="True">
                            <DataTrigger.EnterActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation
                                            Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"
                                            To="0"
                                            Duration="0:0:0.3">
                                            <DoubleAnimation.EasingFunction>
                                                <QuadraticEase EasingMode="EaseInOut" />
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>

                                    </Storyboard>
                                </BeginStoryboard>
                            </DataTrigger.EnterActions>
                            <DataTrigger.ExitActions>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation
                                            Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"
                                            To="-200"
                                            Duration="0:0:0.3">
                                            <DoubleAnimation.EasingFunction>
                                                <QuadraticEase EasingMode="EaseInOut" />
                                            </DoubleAnimation.EasingFunction>
                                        </DoubleAnimation>

                                    </Storyboard>
                                </BeginStoryboard>
                            </DataTrigger.ExitActions>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Border.Style>
        </Border>
    </Grid>
</Window>
